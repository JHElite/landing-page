---
import LogoLink from "./common/logo-link.astro";
---

<div class="bg-base-100">
  <div
    id="site-logo-area"
    class="site-width-content site-px site-py flex justify-center items-center gap-2 bg-base-100"
  >
    <LogoLink
      variant="large"
      class="py-[12vw] sm:py-[5rem]"
      iconProps={{ class: "w-[75vw] sm:w-[30rem] h-auto" }}
    />
  </div>
</div>
<header class="bg-base-200 shadow-2xl sticky top-0 z-50">
  <nav class="site-width-content site-px py-4 flex justify-between">
    <LogoLink
      variant="large"
      id="nav-logo"
      iconProps={{ class: "h-10" }}
      class="-translate-x-1/4 opacity-0 duration-300"
    />
    <div class="flex gap-2">
      {
        [{ pathname: "/#about", label: "About" }].map(({ pathname, label }) => (
          <a
            href={pathname}
            class:list={[
              "btn btn-outline no-animation",
              { "btn-active": Astro.url.pathname === pathname },
            ]}
            data-astro-prefetch
          >
            {label}
          </a>
        ))
      }
    </div>
  </nav>
</header>

<script>
  document.addEventListener("astro:page-load", () => {
    const siteLogoAreaHeight =
      document.getElementById("site-logo-area")?.offsetHeight ?? 0;
    const navLogo = document.getElementById("nav-logo");

    let navLogoVisible = false;
    const manageNavLogoClasses = () => {
      if (window.scrollY >= siteLogoAreaHeight) {
        if (navLogoVisible) return;
        navLogo?.classList.remove("-translate-x-1/4", "opacity-0");
        navLogoVisible = true;
      } else {
        if (!navLogoVisible) return;
        navLogo?.classList.add("-translate-x-1/4", "opacity-0");
        navLogoVisible = false;
      }
    };

    manageNavLogoClasses();
    window.addEventListener("scroll", manageNavLogoClasses);

    /**
     * adding transition only after first scroll avoids slide animation
     * if browser restores place after reload
     */
    window.addEventListener(
      "scroll",
      () => {
        navLogo?.classList.add("transition");
      },
      { once: true },
    );
  });
</script>
